var system=require("system"),probePage=new WebPage,printPage=new WebPage,inputFile=system.args[1]||"index.html?print-pdf",outputFile=system.args[2]||"slides.pdf";outputFile.match(/\.pdf$/gi)===null&&(outputFile+=".pdf"),console.log("Export PDF: Reading reveal.js config [1/4]"),probePage.open(inputFile,function(t){console.log("Export PDF: Preparing print layout [2/4]");var e=probePage.evaluate(function(){return Reveal.getConfig()});e?(printPage.paperSize={width:Math.floor(e.width*(1+e.margin)),height:Math.floor(e.height*(1+e.margin)),border:0},printPage.open(inputFile,function(o){console.log("Export PDF: Preparing pdf [3/4]"),printPage.evaluate(function(){Reveal.isReady()?window.callPhantom():Reveal.addEventListener("pdf-ready",window.callPhantom)})}),printPage.onCallback=function(o){setTimeout(function(){console.log("Export PDF: Writing file [4/4]"),printPage.render(outputFile),console.log("Export PDF: Finished successfully!"),phantom.exit()},0)}):(console.log("Export PDF: Unable to read reveal.js config. Make sure the input address points to a reveal.js page."),phantom.exit(1))});
